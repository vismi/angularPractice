var cov_nn9o68qac=function(){var path='/home/traning/ExpressAngular/routes/login.js',hash='d10d889ef0df74bd72eb052be0e3df99b25e065d',global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/home/traning/ExpressAngular/routes/login.js',statementMap:{'0':{start:{line:1,column:12},end:{line:1,column:30}},'1':{start:{line:2,column:11},end:{line:2,column:27}},'2':{start:{line:3,column:10},end:{line:3,column:44}},'3':{start:{line:4,column:11},end:{line:4,column:38}},'4':{start:{line:5,column:13},end:{line:5,column:32}},'5':{start:{line:6,column:8},end:{line:6,column:31}},'6':{start:{line:7,column:0},end:{line:26,column:3}},'7':{start:{line:8,column:1},end:{line:25,column:4}},'8':{start:{line:9,column:2},end:{line:24,column:3}},'9':{start:{line:10,column:3},end:{line:10,column:44}},'10':{start:{line:13,column:3},end:{line:23,column:6}},'11':{start:{line:14,column:4},end:{line:22,column:5}},'12':{start:{line:15,column:17},end:{line:17,column:6}},'13':{start:{line:18,column:17},end:{line:18,column:67}},'14':{start:{line:19,column:5},end:{line:19,column:54}},'15':{start:{line:21,column:5},end:{line:21,column:91}},'16':{start:{line:29,column:15},end:{line:41,column:1}},'17':{start:{line:30,column:1},end:{line:30,column:36}},'18':{start:{line:31,column:2},end:{line:40,column:3}},'19':{start:{line:32,column:17},end:{line:32,column:49}},'20':{start:{line:33,column:4},end:{line:37,column:5}},'21':{start:{line:34,column:6},end:{line:34,column:23}},'22':{start:{line:36,column:6},end:{line:36,column:18}},'23':{start:{line:39,column:4},end:{line:39,column:16}},'24':{start:{line:43,column:0},end:{line:55,column:3}},'25':{start:{line:44,column:14},end:{line:44,column:35}},'26':{start:{line:45,column:2},end:{line:54,column:3}},'27':{start:{line:46,column:4},end:{line:50,column:3}},'28':{start:{line:47,column:6},end:{line:47,column:32}},'29':{start:{line:47,column:15},end:{line:47,column:32}},'30':{start:{line:49,column:0},end:{line:49,column:52}},'31':{start:{line:53,column:4},end:{line:53,column:71}},'32':{start:{line:57,column:0},end:{line:57,column:22}}},fnMap:{'0':{name:'(anonymous_0)',decl:{start:{line:7,column:17},end:{line:7,column:18}},loc:{start:{line:7,column:30},end:{line:26,column:1}},line:7},'1':{name:'(anonymous_1)',decl:{start:{line:8,column:70},end:{line:8,column:71}},loc:{start:{line:8,column:82},end:{line:25,column:2}},line:8},'2':{name:'(anonymous_2)',decl:{start:{line:13,column:41},end:{line:13,column:42}},loc:{start:{line:13,column:65},end:{line:23,column:4}},line:13},'3':{name:'(anonymous_3)',decl:{start:{line:29,column:15},end:{line:29,column:16}},loc:{start:{line:29,column:34},end:{line:41,column:1}},line:29},'4':{name:'(anonymous_4)',decl:{start:{line:43,column:75},end:{line:43,column:76}},loc:{start:{line:43,column:94},end:{line:55,column:1}},line:43},'5':{name:'(anonymous_5)',decl:{start:{line:46,column:15},end:{line:46,column:16}},loc:{start:{line:46,column:36},end:{line:50,column:1}},line:46}},branchMap:{'0':{loc:{start:{line:9,column:2},end:{line:24,column:3}},type:'if',locations:[{start:{line:9,column:2},end:{line:24,column:3}},{start:{line:9,column:2},end:{line:24,column:3}}],line:9},'1':{loc:{start:{line:14,column:4},end:{line:22,column:5}},type:'if',locations:[{start:{line:14,column:4},end:{line:22,column:5}},{start:{line:14,column:4},end:{line:22,column:5}}],line:14},'2':{loc:{start:{line:31,column:2},end:{line:40,column:3}},type:'if',locations:[{start:{line:31,column:2},end:{line:40,column:3}},{start:{line:31,column:2},end:{line:40,column:3}}],line:31},'3':{loc:{start:{line:31,column:6},end:{line:31,column:38}},type:'binary-expr',locations:[{start:{line:31,column:6},end:{line:31,column:13}},{start:{line:31,column:17},end:{line:31,column:38}}],line:31},'4':{loc:{start:{line:33,column:4},end:{line:37,column:5}},type:'if',locations:[{start:{line:33,column:4},end:{line:37,column:5}},{start:{line:33,column:4},end:{line:37,column:5}}],line:33},'5':{loc:{start:{line:45,column:2},end:{line:54,column:3}},type:'if',locations:[{start:{line:45,column:2},end:{line:54,column:3}},{start:{line:45,column:2},end:{line:54,column:3}}],line:45},'6':{loc:{start:{line:47,column:6},end:{line:47,column:32}},type:'if',locations:[{start:{line:47,column:6},end:{line:47,column:32}},{start:{line:47,column:6},end:{line:47,column:32}}],line:47}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();let express=(cov_nn9o68qac.s[0]++,require('express'));let router=(cov_nn9o68qac.s[1]++,express.Router());let login=(cov_nn9o68qac.s[2]++,require('../model/schemaRegister'));let config=(cov_nn9o68qac.s[3]++,require('../config/config'));let passport=(cov_nn9o68qac.s[4]++,require('passport'));let jwt=(cov_nn9o68qac.s[5]++,require('jsonwebtoken'));cov_nn9o68qac.s[6]++;router.post('/',(req,res)=>{cov_nn9o68qac.f[0]++;cov_nn9o68qac.s[7]++;login.findOne({"Email":req.body.Email,"Password":req.body.Password},(err,data)=>{cov_nn9o68qac.f[1]++;cov_nn9o68qac.s[8]++;if(data==undefined){cov_nn9o68qac.b[0][0]++;cov_nn9o68qac.s[9]++;res.json({'Message':'Invalid Email id'});}else{cov_nn9o68qac.b[0][1]++;cov_nn9o68qac.s[10]++;data.passwordMatch(req.body.Password,function(err,Matched){cov_nn9o68qac.f[2]++;cov_nn9o68qac.s[11]++;if(Matched){cov_nn9o68qac.b[1][0]++;let payload=(cov_nn9o68qac.s[12]++,{Email:data.Email});var token=(cov_nn9o68qac.s[13]++,jwt.sign(payload,config.secret,{expiresIn:'1h'}));cov_nn9o68qac.s[14]++;res.json({success:true,token:'jwt '+token});}else{cov_nn9o68qac.b[1][1]++;cov_nn9o68qac.s[15]++;res.status(401).send({success:false,msg:'Authentication failed. Wrong password.'});}});}});});cov_nn9o68qac.s[16]++;let getToken=function(headers){cov_nn9o68qac.f[3]++;cov_nn9o68qac.s[17]++;console.log(headers.authorization);cov_nn9o68qac.s[18]++;if((cov_nn9o68qac.b[3][0]++,headers)&&(cov_nn9o68qac.b[3][1]++,headers.authorization)){cov_nn9o68qac.b[2][0]++;let parted=(cov_nn9o68qac.s[19]++,headers.authorization.split(' '));cov_nn9o68qac.s[20]++;if(parted.length===2){cov_nn9o68qac.b[4][0]++;cov_nn9o68qac.s[21]++;return parted[1];}else{cov_nn9o68qac.b[4][1]++;cov_nn9o68qac.s[22]++;return null;}}else{cov_nn9o68qac.b[2][1]++;cov_nn9o68qac.s[23]++;return null;}};cov_nn9o68qac.s[24]++;router.get('/loginvalue',passport.authenticate('jwt',{session:false}),function(req,res){cov_nn9o68qac.f[4]++;var token=(cov_nn9o68qac.s[25]++,getToken(req.headers));cov_nn9o68qac.s[26]++;if(token){cov_nn9o68qac.b[5][0]++;cov_nn9o68qac.s[27]++;login.find(function(err,data){cov_nn9o68qac.f[5]++;cov_nn9o68qac.s[28]++;if(err){cov_nn9o68qac.b[6][0]++;cov_nn9o68qac.s[29]++;return next(err);}else{cov_nn9o68qac.b[6][1]++;}//     res.json(data);
cov_nn9o68qac.s[30]++;res.json({success:true,token:'bearer '+token});});}else{cov_nn9o68qac.b[5][1]++;cov_nn9o68qac.s[31]++;return res.status(403).send({success:false,msg:'Unauthorized'});}});cov_nn9o68qac.s[32]++;module.exports=router;